"use strict";function t(t){return t&&"object"==typeof t&&"default"in t?t.default:t}Object.defineProperty(exports,"__esModule",{value:!0});var e=require("docx"),r=t(require("tinycolor2")),n=t(require("jszip")),o=require("html-to-ast"),i=require("file-saver");function a(){a=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},u=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",l=i.toStringTag||"@@toStringTag";function s(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{s({},"")}catch(t){s=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=Object.create((e&&e.prototype instanceof y?e:y).prototype),a=new N(n||[]);return o(i,"_invoke",{value:L(t,r,a)}),i}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var h="suspendedStart",d="executing",v="completed",g={};function y(){}function m(){}function b(){}var x={};s(x,u,(function(){return this}));var w=Object.getPrototypeOf,k=w&&w(w(P([])));k&&k!==r&&n.call(k,u)&&(x=k);var j=b.prototype=y.prototype=Object.create(x);function T(t){["next","throw","return"].forEach((function(e){s(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function r(o,i,a,u){var c=p(t[o],t,i);if("throw"!==c.type){var l=c.arg,s=l.value;return s&&"object"==typeof s&&n.call(s,"__await")?e.resolve(s.__await).then((function(t){r("next",t,a,u)}),(function(t){r("throw",t,a,u)})):e.resolve(s).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,u)}))}u(c.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function L(e,r,n){var o=h;return function(i,a){if(o===d)throw new Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var u=n.delegate;if(u){var c=S(u,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var l=p(e,r,n);if("normal"===l.type){if(o=n.done?v:"suspendedYield",l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(o=v,n.method="throw",n.arg=l.arg)}}}function S(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,S(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function O(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(O,this),this.reset(!0)}function P(e){if(e||""===e){var r=e[u];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(typeof e+" is not iterable")}return m.prototype=b,o(j,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=s(b,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,s(t,l,"GeneratorFunction")),t.prototype=Object.create(j),t},e.awrap=function(t){return{__await:t}},T(E.prototype),s(E.prototype,c,(function(){return this})),e.AsyncIterator=E,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new E(f(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},T(j),s(j,l,"Generator"),s(j,u,(function(){return this})),s(j,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=P,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(A),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return u.type="throw",u.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],u=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),l=n.call(a,"finallyLoc");if(c&&l){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),A(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;A(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:P(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function u(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){u(i,n,o,a,c,"next",t)}function c(t){u(i,n,o,a,c,"throw",t)}a(void 0)}))}}function l(){return(l=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}).apply(this,arguments)}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(r)return(r=r.call(t)).next.bind(r);if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return s(t,void 0);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,void 0):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0;return function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var p={left:e.AlignmentType.LEFT,center:e.AlignmentType.CENTER,right:e.AlignmentType.RIGHT},h={p:"line-height: 1.5;",strong:"font-weight: bold;",em:"font-style: italic;",u:"text-decoration: underline;",del:"text-decoration: line-through;",h1:"font-weight: bold; font-size: 40px; line-height: 1.5;",h2:"font-weight: bold; font-size: 36px; line-height: 1.5;",h3:"font-weight: bold; font-size: 24px; line-height: 1.5;",h4:"font-weight: bold; font-size: 18px; line-height: 1.5;",h5:"font-weight: bold; font-size: 15px; line-height: 1.5;",h6:"font-weight: bold; font-size: 13px; line-height: 1.5;",sub:"subscript: true;",sup:"superscript: true;",a:"text-decoration: underline; color: #007AFF;"},d={bottomMargin:"2.54cm",leftMargin:"3.18cm",rightMargin:"3.18cm",topMargin:"2.54cm",orientation:e.PageOrientation.PORTRAIT},v={"padding-left":"left","padding-right":"right","padding-top":"start","padding-bottom":"end"},g={type:"single",color:"3d4757"},y={style:e.BorderStyle.SINGLE,size:0,color:"#fff"},m={top:e.VerticalAlign.TOP,middle:e.VerticalAlign.CENTER,bottom:e.VerticalAlign.BOTTOM};function b(t){return{"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regExp","[object Undefined]":"undefined","[object Null]":"null","[object Object]":"object"}[Object.prototype.toString.call(t)]}var x=function(t){return Array.isArray(t)&&t.length>0},w=function(t){return function(t){return t.replace(/<div[^>]*?>|<\/div>/gi,"")}(function(t){var e={lt:"<",gt:">",nbsp:" ",amp:"&",quot:'"'};return t.replace(/&(lt|gt|nbsp|amp|quot);/gi,(function(t,r){return e[r]}))}(t))},k=function(t){return JSON.parse(JSON.stringify(t))},j=function(t){var e=t.match(/\d+(.\d+)?/g);if(t.match(/\d+(.\d+)?/g)&&e&&Array.isArray(e)&&e[0]){var r=e[0],n=r?t.replace(new RegExp(r,"g"),""):"";return{value:parseFloat(r),type:n}}return{type:"UNKNOWN",value:0}},T=function(t){return e.convertMillimetersToTwip(10*(r=t,parseFloat(null==r?void 0:r.toUpperCase().replace(/CM/i,""))));var r},E=function(t,e){void 0===e&&(e=1);var r=t.trimEnd(),n=t.slice(r.length),o=1===e?n:new Array(n.length*e).fill(" ").join("");return n.length>1?""+r+o+"\t":t},L=function(){var t=c(a().mark((function t(e){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch(e).then((function(t){return t.blob()}));case 2:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=[{name:"color",judge:function(t){return"color"===t.key},handler:function(t,e){var r=t.val,n=k(e);return n.color=r.replace(/#/g,""),n}},{name:"backgroundColor",judge:function(t){return"background-color"===t.key},handler:function(t,r){var n=t.val,o=k(r);return o.shading={type:e.ShadingType.CLEAR,fill:n.replace(/#/g,"")},o}},{name:"bold",judge:function(t){return"font-weight"===t.key&&"bold"===t.val.toLowerCase()},handler:function(t,e){var r=k(e);return r.bold=!0,r}},{name:"align",judge:function(t){return t.key.indexOf("text-align")>-1},handler:function(t,r){var n=t.val,o=k(r);return o.alignment=p[n]||e.AlignmentType.LEFT,o}},{name:"borderColor",judge:function(t){return"border-color"===t.key},handler:function(t,e){var r=t.val,n=k(e);return n.borderColor=r.replace(/#/i,""),n}},{name:"fontFamily",judge:function(t){return"font-family"===t.key},handler:function(t,e){var r=t.val,n=k(e);return-1===r.indexOf(",")&&-1===r.indexOf(" ")&&(n.font=r),n}},{name:"fontStyle",judge:function(t){return"font-style"===t.key},handler:function(t,e){var r=k(e);return r.italics=!0,r}},{name:"height",judge:function(t){return"height"===t.key},handler:function(t,e){var r=t.val,n=k(e),o=parseFloat(r.replace(/px/i,""));return n.tHeight=o,n}},{name:"lineHeight",judge:function(t){return"line-height"===t.key},handler:function(t,r){var n=t.val,o=k(r),i={},a=j(n),u=a.value,c=a.type,l="px"===c.toLowerCase(),s="%"==c.toLowerCase(),f=u;return l&&u?f=u/16:s&&(f=u/100),!u||1==f||(i.line=240*f,i.lineRule=e.LineRuleType.AUTO),o.spacing=i,o}},{name:"padding",judge:function(t){return t.key.indexOf("padding-")>-1},handler:function(t,e){var r=t.key,n=t.val,o=k(e),i=v[r]||"left",a=j(n),u=a.value,c=a.type,l={},s=(o.size||16.3)/(3/4)/2*16,f=c.match("em"),p=c.match("px"),h=c.match("pt"),d=0;return f?d=u*s:p?d=u/20*s:h&&(d=u/(3/4*16.3)*s),l[i]=d,o.indent=l,o}},{name:"textDecoration",judge:function(t){return"text-decoration"===t.key},handler:function(t,e){var r=t.val,n=k(e);return"line-through"===r?n.strike=!0:"underline"===r&&(n.underline=g),n}},{name:"textIndent",judge:function(t){return"text-indent"===t.key},handler:function(t,e){var r=t.val,n=k(e),o=j(r),i=o.value,a=o.type,u={},c=(n.size||16.3)/(3/4)/2*16,l=a.match("em"),s=a.match("px"),f=a.match("pt"),p=0;return l?p=i*c:s?p=i/20*c:f&&(p=i/(3/4*16.3)*c),u.firstLine=p,n.indent=u,n}},{name:"verticalAlign",judge:function(t){return"vertical-align"===t.key},handler:function(t,e){var r=t.val,n=k(e);return n.verticalAlign=m[r],n}},{name:"width",judge:function(t){return"width"===t.key},handler:function(t,e){var r=t.val,n=k(e),o=parseFloat(r.replace(/%/i,""));return n.tWidth=o,n}},{name:"subScript",judge:function(t){return"subscript"===t.key&&"true"===t.val.toLowerCase()},handler:function(t,e){var r=k(e);return r.subScript=!0,r}},{name:"superScript",judge:function(t){return"superscript"===t.key&&"true"===t.val.toLowerCase()},handler:function(t,e){var r=k(e);return r.superScript=!0,r}}],O=function(t){return t&&"text"===t.type&&t.content},A=function(t,e){void 0===e&&(e=h);var n={};if(!t||0===t.length)return n;var o=Object.keys(e),i=t.filter((function(t){return o.includes(t)})).map((function(t){return e[t]})).filter(Boolean),a=function(t,e){void 0===e&&(e="id");var r=t.every((function(t){return"object"===b(t)}));if(!x(t)||1===t.length||!r)return t;var n=[];return t.reduce((function(t,r){var o=r[e];return o&&!n.includes(o)&&(n.push(o),t.push(r)),t}),[])}([].concat(t,i).filter(Boolean).map((function(t){return t.split(";")})).flat().filter((function(t){return t.indexOf(":")>-1})).map((function(t){var e=t.trim().split(":"),n=e[0],o=e[1],i="string"===b(o)?o.trim().replace(/;/i,""):o,a=r(i).isValid()?r(i).toHexString():i;return{key:n.trim(),val:a}})),"key"),u=a.find((function(t){return"font-size"===t.key})),c=u&&u.val?j(u.val):null;if(c){var s=c.value;n.size="pt"===c.type?2*s:s*(3/4)*2}else n.size=3/4*16.3*2;var f=function(t){var e={};return t.forEach((function(t){var r=S.find((function(e){return e.judge(t)}));r&&(e=r.handler(t,e))})),e}(a);return l({},n,f)},N=function(t,r){void 0===r&&(r=h);var n=t.shape,o={text:E(t.content)},i=n&&n.length?A(n,r):{};return new e.TextRun(l({},o,i))},P=function(){var t=c(a().mark((function t(r,n){var o,i;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=h),o=[],i=function(){var t=c(a().mark((function t(r,o){var u,c,l,s,p,h,d,v,g,y,m,b,w;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:u=f(r);case 1:if((c=u()).done){t.next=42;break}if(!O(l=c.value)){t.next=7;break}o.push(N(l,n)),t.next=40;break;case 7:if("img"!==l.name){t.next=25;break}if(p=(s=l.attrs).src,d=void 0===(h=s.width)?100:h,g=void 0===(v=s.height)?100:v,y=A(l.shape),!p){t.next=23;break}return t.prev=12,t.next=15,L(String(p));case 15:m=new e.ImageRun({data:t.sent,transformation:{width:y.tWidth||Number(d),height:y.tHeight||Number(g)}}),o.push(m),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(12),console.log("download image error",t.t0);case 23:t.next=40;break;case 25:if(!x(l.children)){t.next=40;break}if("a"!==l.name){t.next=38;break}return b=l.attrs,t.t1=e.ExternalHyperlink,t.next=31,P(l.children,n);case 31:t.t2=t.sent,t.t3=b.href?String(b.href):"",t.t4={children:t.t2,link:t.t3},w=new t.t1(t.t4),o.push(w),t.next=40;break;case 38:return t.next=40,i(l.children,o);case 40:t.next=1;break;case 42:case"end":return t.stop()}}),t,null,[[12,20]])})));return function(e,r){return t.apply(this,arguments)}}(),t.next=5,i(r,o);case 5:return t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),C=function(t,r){return{style:e.BorderStyle.SINGLE,size:10*t,color:r}},_=function(t){var e=t.length,r=e?553/e:0;return t.filter((function(t){return"col"===t.name})).map((function(t){var e;return 9035/553*((null==(e=j(String(t.attrs.width)))?void 0:e.value)||r)}))},z=function(t,e,r){return t.slice(e,e+r).reduce((function(t,e){return t+e}),0)},F=function(){var t=c(a().mark((function t(r,n){var o,i,u,c,s,p,d,v,g,m,b,x,w,k,j,T,E,L,S,O,N,F,M,I,R,D,G,H,W,B,q,U,X,V,J,Y,Z,K,$,Q,tt,et,rt,nt,ot,it,at,ut,ct,lt,st,ft,pt,ht;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n=h),i=r.attrs,u=r.shape,c=(o=r.children).find((function(t){return"tbody"===t.name}))){t.next=6;break}return t.abrupt("return",null);case 6:s=o.find((function(t){return"colgroup"===t.name})),p=s?_(s.children):[],d={layout:e.TableLayoutType.FIXED,borders:{top:y,left:y,right:y,bottom:y},rows:[]},v=A(u,n),m=(g=i.border)?parseFloat(g):2,x={top:C(m,b=v.borderColor||"444444"),right:C(m,b),bottom:C(m,b),left:C(m,b)},d.borders=x,w=function(t){return"td"===t.name},k=[],j=!1,T=c.children.filter((function(t){return"tr"===t.name})),E=[],L=f(T.map((function(t,e){return{tr:t,idx:e}})));case 22:if((S=L()).done){t.next=69;break}M=(N=S.value).idx,I=(F=N.tr).children,D=null!=(R=F.attrs)&&R.style&&(null==(O=A([null==R?void 0:R.style],n))?void 0:O.tHeight)||18,G=I.filter(w),H=[],W=f(G.map((function(t,e){return{item:t,index:e}})));case 29:if((B=W()).done){t.next=63;break}X=(q=B.value).index,V=(U=q.item).attrs,J=U.shape,delete(Y=l({},n)).p,Z=A(J,Y),K=[],$=f(U.children);case 38:if((Q=$()).done){t.next=49;break}if(et=(tt=Q.value).shape,rt=tt.content,null==(nt=tt.children)||!nt.length){t.next=46;break}return t.next=44,P(nt||[],Y);case 44:K.push(new e.Paragraph(l({children:t.sent},A(et,Y))));case 46:K.push(new e.Paragraph(l({text:rt},A(et,Y))));case 47:t.next=38;break;case 49:if(ot={children:K},at=V.rowspan,(it=V.colspan)&&0!==Number(it)&&(ot.columnSpan=Number(it)),at&&0!==Number(at)&&(ot.rowSpan=Number(at)),(j=!!p.length&&p.every((function(t){return 0!==t})))&&(ut=z(p,X,ot.columnSpan||1),Z.tWidth=ut),ot.width={size:ct=j?Z.tWidth||9035/p.length:(Z.tWidth||185)*(9035/553),type:e.WidthType.DXA},0===M)if(ot.columnSpan)for(lt=0;lt<ot.columnSpan;lt++)k.push(ct/ot.columnSpan);else k.push(ct);st={marginUnitType:e.WidthType.DXA,top:16,bottom:16,left:16,right:16},ft=l({},ot,A(J,Y),{margins:st}),H.push(new e.TableCell(ft));case 61:t.next=29;break;case 63:(pt={children:H,height:{value:0,rule:e.HeightRule.EXACT}}).height={value:(null!=D?D:18)*(9035/553),rule:e.HeightRule.EXACT},E.push(new e.TableRow(pt));case 67:t.next=22;break;case 69:return d.columnWidths=ht=j?p:k,d.width={size:(a=ht,a.reduce((function(t,e){return t+e}),0)),type:e.WidthType.DXA},d.rows=E,t.abrupt("return",d);case 74:case"end":return t.stop()}var a}),t)})));return function(e,r){return t.apply(this,arguments)}}(),M=function(){var t=c(a().mark((function t(r,n){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===n&&(n=h),t.next=3,F(r,n);case 3:if(o=t.sent){t.next=6;break}return t.abrupt("return",null);case 6:return t.abrupt("return",new e.Table(o));case 7:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),I=function(){var t=c(a().mark((function t(r,n){var o,i,u,c,s,f,p,d,v,g,y;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===n&&(n=h),i=r.children,c=r.shape,s={text:u=r.content,children:[]},f="text"===r.type&&u,p="table"===(o=r.name),d="ol"===o||"ul"===o,v=!("a"===o)&&!p&&!d&&i&&x(i)&&i.length>0,!f){t.next=13;break}return g=l({},s,A(c,n)),t.abrupt("return",new e.Paragraph(g));case 13:if(!v){t.next=21;break}return t.next=16,P(i,n);case 16:return s.children=t.sent,y=l({},s,A(c,n)),t.abrupt("return",new e.Paragraph(y));case 21:if(!p){t.next=28;break}return t.next=24,M(r,n);case 24:return t.abrupt("return",t.sent);case 28:if(!d){t.next=32;break}return t.abrupt("return",null);case 32:return t.abrupt("return",null);case 33:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),R=function t(e,r,n){void 0===r&&(r=[]),e&&x(e)&&e.forEach((function(e){var n=e.attrs,o=e.children,i=e.name,a="string"==typeof(null==n?void 0:n.style)?[n.style].concat(r):r,u=i?[i].concat(a):[].concat(a);e.shape=u,x(o)&&t(o,u)}))},D=function(t,e){var r=[].concat(t);return R(r,[]),r},G=function(){var t=c(a().mark((function t(e,r){var n,o,i,u,c,l;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===r&&(r=h),e&&0!==e.length){t.next=3;break}return t.abrupt("return",[]);case 3:if(n=D(e.filter((function(t){return"tag"===t.type})))){t.next=6;break}return t.abrupt("return",[]);case 6:o=[],i=f(n);case 8:if((u=i()).done){t.next=16;break}return c=u.value,t.next=12,I(c,r);case 12:(l=t.sent)&&o.push(l);case 14:t.next=8;break;case 16:return t.abrupt("return",[].concat(o));case 17:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),H=function(t){return o.parse(t)},W=function(){var t=c(a().mark((function t(r,n){var i,u,c,s,f,p,v,g,y,m,b,x,w,k,j;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return i=l({},d,(null==n?void 0:n.layout)||{}),u=(null==n?void 0:n.tagStyleMap)||h,c=H(r),t.next=6,G(c,u);case 6:if(s=t.sent,f=i.orientation,p=i.leftMargin,v=i.rightMargin,g=i.bottomMargin,y=i.header,m=i.footer,b={top:T(i.topMargin),left:T(p),right:T(v),bottom:T(g)},x={properties:{page:{margin:b,size:{orientation:f}}},children:s,headers:{},footers:{}},!y){t.next=20;break}return w=o.parse(y),t.t0=e.Header,t.next=16,G(w,u);case 16:t.t1=t.sent,t.t2={children:t.t1},t.t3=new t.t0(t.t2),x.headers={default:t.t3};case 20:if(!m){t.next=29;break}return k=o.parse(m),t.t4=e.Footer,t.next=25,G(k,u);case 25:t.t5=t.sent,t.t6={children:t.t5},t.t7=new t.t4(t.t6),x.footers={default:t.t7};case 29:return j=new e.Document({styles:{paragraphStyles:[]},sections:[x]}),t.abrupt("return",j);case 31:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),B=function(){var t=c(a().mark((function t(r,n){return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:void 0===n&&(n=""),e.Packer.toBlob(r).then((function(t){i.saveAs(t,n+".docx")}));case 2:case"end":return t.stop()}}),t)})));return function(e,r){return t.apply(this,arguments)}}(),q=function(){var t=c(a().mark((function t(e,r,n){var o;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return void 0===r&&(r="doc"),t.next=3,W(w(e),n);case 3:return B(o=t.sent,r),t.abrupt("return",o);case 6:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),U=function(){var t=c(a().mark((function t(r,o,u){var c,l,s,p,h,d,v,g,y,m,b,x;return a().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0===o&&(o="docs"),c=new n,1!==r.length){t.next=11;break}return s=(l=r[0]).html,p=l.name,h=l.option,t.next=8,W(w(s),h||u);case 8:return B(t.sent,p),t.abrupt("return");case 11:d=f(r);case 12:if((v=d()).done){t.next=24;break}return y=(g=v.value).html,m=g.name,b=g.option,t.next=17,W(w(y),b||u);case 17:return x=t.sent,t.next=20,e.Packer.toBlob(x);case 20:c.file(m+".docx",t.sent);case 22:t.next=12;break;case 24:c.generateAsync({type:"blob"}).then((function(t){i.saveAs(t,o+".zip")}));case 25:case"end":return t.stop()}}),t)})));return function(e,r,n){return t.apply(this,arguments)}}(),X=U;Object.defineProperty(exports,"parse",{enumerable:!0,get:function(){return o.parse}}),exports.D_Layout=d,exports.D_TagStyleMap=h,exports.ElementCreator=G,exports.StyleBuilder=D,exports.chainStyle=R,exports.exportAsDocx=B,exports.exportAsZip=X,exports.exportHtmlToDocx=q,exports.exportMultiDocsAsZip=U,exports.genDocument=W,exports.getInnerTextNode=function(t){for(var e=t;e&&e.children&&1===e.children.length;)e=e.children[0];return e},exports.htmlToAST=H,exports.tableNodeToITableOptions=F;
//# sourceMappingURL=editor-to-word.cjs.production.min.js.map
